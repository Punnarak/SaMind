{"version":3,"sources":["BaseCalendar.tsx"],"names":["dayjs","extend","localeData","localizedFormat","utc","BaseCalendar","ArrowComponent","CustomArrow","TitleComponent","CustomTitle","WeekdaysComponent","CustomWeekdays","DayComponent","MonthComponent","allowYearView","showExtraDates","onPressDay","maxDate","minDate","initVisibleDate","dateProperties","testID","theme","React","useContext","ThemeContext","locale","LocaleContext","rightArrowDisabled","disableRightArrow","leftArrowDisabled","disableLeftArrow","activeView","setActiveView","VIEW","MONTH","visibleDate","setVisibleDate","local","format","localeAwareVisibleDate","useMemo","name","weekdays","weekdaysShort","month","year","verifyUnitIsPastMaxDate","unit","isAfter","verifyUnitIsBeforeMinDate","isBefore","toggleCalendarView","newVisibleDate","_month","_year","YEAR","next","last","start","end","addMonth","afterNext","current","subtractMonth","beforeLast","addYear","persistMonth","subtractYear","onPressMonth","Weekdays","DefaultWeekdays","Arrow","DefaultArrow","Title","DefaultTitle","calendarContainer","headerContainer","undefined"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AAEA;;;;;;;;AAkBAA,eAAMC,MAAN,CAAaC,mBAAb;;AACAF,eAAMC,MAAN,CAAaE,wBAAb;;AACAH,eAAMC,MAAN,CAAaG,YAAb;;AAsBA,MAAMC,YAA6B,GAAG,CAAC;AACrCC,EAAAA,cAAc,EAAEC,WADqB;AAErCC,EAAAA,cAAc,EAAEC,WAFqB;AAGrCC,EAAAA,iBAAiB,EAAEC,cAHkB;AAIrCC,EAAAA,YAJqC;AAKrCC,EAAAA,cALqC;AAMrCC,EAAAA,aANqC;AAOrCC,EAAAA,cAPqC;AAQrCC,EAAAA,UARqC;AASrCC,EAAAA,OATqC;AAUrCC,EAAAA,OAVqC;AAWrCC,EAAAA,eAXqC;AAYrCC,EAAAA,cAZqC;AAarCC,EAAAA;AAbqC,CAAD,KAchC;AACJ,QAAMC,KAAK,GAAGC,eAAMC,UAAN,CAAwBC,sBAAxB,CAAd;;AACA,QAAMC,MAAM,GAAGH,eAAMC,UAAN,CAAyBG,uBAAzB,CAAf;;AAEA,QAAM,CAACC,kBAAD,EAAqBC,iBAArB,IAA0C,qBAAkB,KAAlB,CAAhD;AACA,QAAM,CAACC,iBAAD,EAAoBC,gBAApB,IAAwC,qBAAkB,KAAlB,CAA9C;AACA,QAAM,CAACC,UAAD,EAAaC,aAAb,IAA8B,qBAAeC,gBAAKC,KAApB,CAApC;AACA,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgC,qBACpClB,eADoC,aACpCA,eADoC,cACpCA,eADoC,GACjB,sBAAQmB,KAAR,GAAgBC,MAAhB,EADiB,CAAtC;;AAIA,QAAMC,sBAAsB,GAAGjB,eAAMkB,OAAN,CAC7B,MAAM,oBAAML,WAAN,EAAmBV,MAAnB,CAA0BA,MAAM,CAACgB,IAAjC,EAAuChB,MAAvC,CADuB,EAE7B,CAACA,MAAD,EAASU,WAAT,CAF6B,CAA/B;;AAKA,QAAMO,QAAQ,GAAGpB,eAAMkB,OAAN,CAAc;AAAA;;AAAA,oCAAMf,MAAM,CAACkB,aAAb,yEAA8B,CAAC,EAAD,CAA9B;AAAA,GAAd,EAAkD,CAAClB,MAAD,CAAlD,CAAjB;;AAEA,QAAM;AAAEmB,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAkB,oCAAwBV,WAAxB,CAAxB;AAEA,QAAMW,uBAAuB,GAAG,wBAC7BC,IAAD,IAAU;AACR,QAAI/B,OAAJ,EAAa;AACX,UAAI+B,IAAI,CAACC,OAAL,CAAahC,OAAb,CAAJ,EAA2B;AACzBY,QAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACD,OAFD,MAEO;AACLA,QAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACD;AACF;AACF,GAT6B,EAU9B,CAACA,iBAAD,EAAoBZ,OAApB,CAV8B,CAAhC;AAaA,QAAMiC,yBAAyB,GAAG,wBAC/BF,IAAD,IAAU;AACR,QAAI9B,OAAJ,EAAa;AACX,UAAI8B,IAAI,CAACG,QAAL,CAAcjC,OAAd,CAAJ,EAA4B;AAC1Ba,QAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACD,OAFD,MAEO;AACLA,QAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACD;AACF;AACF,GAT+B,EAUhC,CAACA,gBAAD,EAAmBb,OAAnB,CAVgC,CAAlC;AAaA,QAAMkC,kBAAkB,GAAG,wBACzB,CAACC,cAAsB,GAAGjB,WAA1B,KAA0C;AACxC,UAAM;AAAES,MAAAA,KAAK,EAAES,MAAT;AAAiBR,MAAAA,IAAI,EAAES;AAAvB,QAAiC,oCAAwBF,cAAxB,CAAvC;;AAEA,QAAIrB,UAAU,KAAKE,gBAAKC,KAAxB,EAA+B;AAC7BF,MAAAA,aAAa,CAACC,gBAAKsB,IAAN,CAAb;AACAT,MAAAA,uBAAuB,CAACQ,KAAK,CAACE,IAAP,CAAvB;AACAP,MAAAA,yBAAyB,CAACK,KAAK,CAACG,IAAP,CAAzB;AACD;;AAED,QAAI1B,UAAU,KAAKE,gBAAKsB,IAAxB,EAA8B;AAC5BvB,MAAAA,aAAa,CAACC,gBAAKC,KAAN,CAAb;AACAY,MAAAA,uBAAuB,CAACO,MAAM,CAACG,IAAR,CAAvB;AACAP,MAAAA,yBAAyB,CAACI,MAAM,CAACI,IAAR,CAAzB;AACD;AACF,GAfwB,EAgBzB,CAAC1B,UAAD,EAAakB,yBAAb,EAAwCH,uBAAxC,EAAiEX,WAAjE,CAhByB,CAA3B;AAmBA,wBAAU,MAAM;AACdW,IAAAA,uBAAuB,CAACF,KAAK,CAACY,IAAN,CAAWE,KAAZ,CAAvB;AACAT,IAAAA,yBAAyB,CAACL,KAAK,CAACa,IAAN,CAAWE,GAAZ,CAAzB;AACD,GAHD,EAGG,CACDf,KAAK,CAACa,IAAN,CAAWE,GADV,EAEDf,KAAK,CAACY,IAAN,CAAWE,KAFV,EAGDZ,uBAHC,EAIDG,yBAJC,CAHH;AAUA,QAAMW,QAAQ,GAAG,wBAAY,MAAM;AACjCxB,IAAAA,cAAc,CAACQ,KAAK,CAACY,IAAN,CAAWE,KAAX,CAAiBrB,KAAjB,GAAyBC,MAAzB,EAAD,CAAd;AACAQ,IAAAA,uBAAuB,CAACF,KAAK,CAACiB,SAAP,CAAvB;AACAZ,IAAAA,yBAAyB,CAACL,KAAK,CAACkB,OAAN,CAAcH,GAAf,CAAzB;AACD,GAJgB,EAId,CAACf,KAAD,EAAQK,yBAAR,EAAmCH,uBAAnC,CAJc,CAAjB;AAMA,QAAMiB,aAAa,GAAG,wBAAY,MAAM;AACtC3B,IAAAA,cAAc,CAACQ,KAAK,CAACa,IAAN,CAAWC,KAAX,CAAiBrB,KAAjB,GAAyBC,MAAzB,EAAD,CAAd;AACAQ,IAAAA,uBAAuB,CAACF,KAAK,CAACkB,OAAN,CAAcJ,KAAf,CAAvB;AACAT,IAAAA,yBAAyB,CAACL,KAAK,CAACoB,UAAP,CAAzB;AACD,GAJqB,EAInB,CAACpB,KAAD,EAAQK,yBAAR,EAAmCH,uBAAnC,CAJmB,CAAtB;AAMA,QAAMmB,OAAO,GAAG,wBAAY,MAAM;AAChC7B,IAAAA,cAAc,CAACS,IAAI,CAACW,IAAL,CAAUU,YAAV,CAAuB7B,KAAvB,GAA+BC,MAA/B,EAAD,CAAd;AACAQ,IAAAA,uBAAuB,CAACD,IAAI,CAACgB,SAAN,CAAvB;AACAZ,IAAAA,yBAAyB,CAACJ,IAAI,CAACiB,OAAL,CAAaH,GAAd,CAAzB;AACD,GAJe,EAIb,CAACd,IAAD,EAAOI,yBAAP,EAAkCH,uBAAlC,CAJa,CAAhB;AAMA,QAAMqB,YAAY,GAAG,wBAAY,MAAM;AACrC/B,IAAAA,cAAc,CAACS,IAAI,CAACY,IAAL,CAAUS,YAAV,CAAuB7B,KAAvB,GAA+BC,MAA/B,EAAD,CAAd;AACAQ,IAAAA,uBAAuB,CAACD,IAAI,CAACiB,OAAL,CAAaJ,KAAd,CAAvB;AACAT,IAAAA,yBAAyB,CAACJ,IAAI,CAACmB,UAAN,CAAzB;AACD,GAJoB,EAIlB,CAACnB,IAAD,EAAOI,yBAAP,EAAkCH,uBAAlC,CAJkB,CAArB;;AAMA,QAAMsB,YAAY,GAAIhB,cAAD,IAA4B;AAC/ChB,IAAAA,cAAc,CAACgB,cAAD,CAAd;AACAD,IAAAA,kBAAkB,CAACC,cAAD,CAAlB;AACD,GAHD;;AAKA,QAAMiB,QAAQ,GAAG3D,cAAc,IAAI4D,oBAAnC;AACA,QAAMC,KAAK,GAAGjE,WAAW,IAAIkE,iBAA7B;AACA,QAAMC,KAAK,GAAGjE,WAAW,IAAIkE,iBAA7B;AAEA,sBACE,6BAAC,iBAAD;AAAM,IAAA,KAAK,EAAErD,KAAK,CAACsD,iBAAnB;AAAsC,IAAA,MAAM,EAAEvD;AAA9C,kBACE,6BAAC,iBAAD;AAAM,IAAA,MAAM,EAAE,QAAd;AAAwB,IAAA,KAAK,EAAEC,KAAK,CAACuD;AAArC,kBACE,6BAAC,KAAD;AACE,IAAA,SAAS,EAAE,MADb;AAEE,IAAA,UAAU,EAAE/C,iBAFd;AAGE,IAAA,OAAO,EAAEE,UAAU,KAAKE,gBAAKC,KAApB,GAA4B6B,aAA5B,GAA4CI;AAHvD,IADF,eAME,6BAAC,KAAD;AACE,IAAA,UAAU,EAAEpC,UADd;AAEE,IAAA,MAAM,EAAEN,MAFV;AAGE,IAAA,IAAI,EAAEc,sBAAsB,CAACD,MAAvB,CAA8B,YAA9B,CAHR;AAIE,IAAA,UAAU,EAAE,CAACzB,aAJf;AAKE,IAAA,OAAO,EAAEsC;AALX,IANF,eAaE,6BAAC,KAAD;AACE,IAAA,SAAS,EAAE,OADb;AAEE,IAAA,UAAU,EAAExB,kBAFd;AAGE,IAAA,OAAO,EAAEI,UAAU,KAAKE,gBAAKC,KAApB,GAA4B0B,QAA5B,GAAuCK;AAHlD,IAbF,CADF,EAoBGlC,UAAU,KAAKE,gBAAKC,KAApB,gBACC,yEACE,6BAAC,QAAD;AAAU,IAAA,IAAI,EAAEQ;AAAhB,IADF,eAEE,6BAAC,gBAAD;AACE,IAAA,YAAY,EAAE/B,YADhB;AAEE,IAAA,WAAW,EAAE4B,sBAFf;AAGE,IAAA,cAAc,EAAE,CAAC,CAACzB,cAHpB;AAIE,IAAA,cAAc,EAAEK,cAJlB;AAKE,IAAA,UAAU,EAAEJ,UALd;AAME,IAAA,OAAO,EAAEE,OANX;AAOE,IAAA,OAAO,EAAED;AAPX,IAFF,CADD,gBAcC,6BAAC,kBAAD;AACE,IAAA,cAAc,EAAEJ,cADlB;AAEE,IAAA,WAAW,EAAE2B,sBAFf;AAGE,IAAA,OAAO,EAAEtB,OAAO,GAAG,oBAAMA,OAAN,EAAeoB,KAAf,GAAuBC,MAAvB,EAAH,GAAqCuC,SAHvD;AAIE,IAAA,OAAO,EAAE7D,OAAO,GAAG,oBAAMA,OAAN,EAAeqB,KAAf,GAAuBC,MAAvB,EAAH,GAAqCuC,SAJvD;AAKE,IAAA,cAAc,EAAE1D,cALlB;AAME,IAAA,YAAY,EAAEiD;AANhB,IAlCJ,CADF;AA8CD,CAxKD;;eA0KehE,Y","sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\nimport { View } from 'react-native';\nimport dayjs from 'dayjs';\n\nimport localeData from 'dayjs/plugin/localeData';\nimport localizedFormat from 'dayjs/plugin/localizedFormat';\nimport utc from 'dayjs/plugin/utc';\n\nimport { getSurroundingTimeUnits } from '../Utils';\nimport { useSurroundingTimeUnits } from '../Hooks';\nimport { ThemeContext, LocaleContext } from '../Contexts';\nimport { VIEW } from '../Constants';\n\nimport {\n  Months,\n  Days,\n  Arrow as DefaultArrow,\n  Title as DefaultTitle,\n  Weekdays as DefaultWeekdays,\n} from '../Components';\n\nimport type {\n  Theme,\n  Locale,\n  ArrowComponentType,\n  TitleComponentType,\n  DayComponentType,\n  MonthComponentType,\n  WeekdaysComponentType,\n} from '../Entities';\n\ndayjs.extend(localeData);\ndayjs.extend(localizedFormat);\ndayjs.extend(utc);\n\nexport interface Props {\n  ArrowComponent?: ArrowComponentType;\n  TitleComponent?: TitleComponentType;\n  DayComponent?: DayComponentType;\n  MonthComponent?: MonthComponentType;\n  WeekdaysComponent?: WeekdaysComponentType;\n  testID?: string;\n  showExtraDates?: boolean;\n  allowYearView?: boolean; // Boolean that disables the calendar year view\n  onPressDay: (date: string) => void; // Recieves a date format string\n  minDate?: string; // YYYY-MM-DD format string respresenting the minimum date that can be selected\n  maxDate?: string; // YYYY-MM-DD format string respresenting the maximum date that can be selected\n  initVisibleDate?: string; // YYYY-MM-DD format string respresenting the date that should be visible when the calendar first renders\n  dateProperties: {\n    [date: string /* YYYY-MM-DD */]: {\n      isSelected?: boolean;\n    };\n  };\n}\n\nconst BaseCalendar: React.FC<Props> = ({\n  ArrowComponent: CustomArrow,\n  TitleComponent: CustomTitle,\n  WeekdaysComponent: CustomWeekdays,\n  DayComponent,\n  MonthComponent,\n  allowYearView,\n  showExtraDates,\n  onPressDay,\n  maxDate,\n  minDate,\n  initVisibleDate,\n  dateProperties,\n  testID,\n}) => {\n  const theme = React.useContext<Theme>(ThemeContext);\n  const locale = React.useContext<Locale>(LocaleContext);\n\n  const [rightArrowDisabled, disableRightArrow] = useState<boolean>(false);\n  const [leftArrowDisabled, disableLeftArrow] = useState<boolean>(false);\n  const [activeView, setActiveView] = useState<VIEW>(VIEW.MONTH);\n  const [visibleDate, setVisibleDate] = useState<string>(\n    initVisibleDate ?? dayjs().local().format()\n  );\n\n  const localeAwareVisibleDate = React.useMemo(\n    () => dayjs(visibleDate).locale(locale.name, locale),\n    [locale, visibleDate]\n  );\n\n  const weekdays = React.useMemo(() => locale.weekdaysShort ?? [''], [locale]);\n\n  const { month, year } = useSurroundingTimeUnits(visibleDate);\n\n  const verifyUnitIsPastMaxDate = useCallback(\n    (unit) => {\n      if (maxDate) {\n        if (unit.isAfter(maxDate)) {\n          disableRightArrow(true);\n        } else {\n          disableRightArrow(false);\n        }\n      }\n    },\n    [disableRightArrow, maxDate]\n  );\n\n  const verifyUnitIsBeforeMinDate = useCallback(\n    (unit) => {\n      if (minDate) {\n        if (unit.isBefore(minDate)) {\n          disableLeftArrow(true);\n        } else {\n          disableLeftArrow(false);\n        }\n      }\n    },\n    [disableLeftArrow, minDate]\n  );\n\n  const toggleCalendarView = useCallback(\n    (newVisibleDate: string = visibleDate) => {\n      const { month: _month, year: _year } = getSurroundingTimeUnits(newVisibleDate);\n\n      if (activeView === VIEW.MONTH) {\n        setActiveView(VIEW.YEAR);\n        verifyUnitIsPastMaxDate(_year.next);\n        verifyUnitIsBeforeMinDate(_year.last);\n      }\n\n      if (activeView === VIEW.YEAR) {\n        setActiveView(VIEW.MONTH);\n        verifyUnitIsPastMaxDate(_month.next);\n        verifyUnitIsBeforeMinDate(_month.last);\n      }\n    },\n    [activeView, verifyUnitIsBeforeMinDate, verifyUnitIsPastMaxDate, visibleDate]\n  );\n\n  useEffect(() => {\n    verifyUnitIsPastMaxDate(month.next.start);\n    verifyUnitIsBeforeMinDate(month.last.end);\n  }, [\n    month.last.end,\n    month.next.start,\n    verifyUnitIsPastMaxDate,\n    verifyUnitIsBeforeMinDate,\n  ]);\n\n  const addMonth = useCallback(() => {\n    setVisibleDate(month.next.start.local().format());\n    verifyUnitIsPastMaxDate(month.afterNext);\n    verifyUnitIsBeforeMinDate(month.current.end);\n  }, [month, verifyUnitIsBeforeMinDate, verifyUnitIsPastMaxDate]);\n\n  const subtractMonth = useCallback(() => {\n    setVisibleDate(month.last.start.local().format());\n    verifyUnitIsPastMaxDate(month.current.start);\n    verifyUnitIsBeforeMinDate(month.beforeLast);\n  }, [month, verifyUnitIsBeforeMinDate, verifyUnitIsPastMaxDate]);\n\n  const addYear = useCallback(() => {\n    setVisibleDate(year.next.persistMonth.local().format());\n    verifyUnitIsPastMaxDate(year.afterNext);\n    verifyUnitIsBeforeMinDate(year.current.end);\n  }, [year, verifyUnitIsBeforeMinDate, verifyUnitIsPastMaxDate]);\n\n  const subtractYear = useCallback(() => {\n    setVisibleDate(year.last.persistMonth.local().format());\n    verifyUnitIsPastMaxDate(year.current.start);\n    verifyUnitIsBeforeMinDate(year.beforeLast);\n  }, [year, verifyUnitIsBeforeMinDate, verifyUnitIsPastMaxDate]);\n\n  const onPressMonth = (newVisibleDate: string) => {\n    setVisibleDate(newVisibleDate);\n    toggleCalendarView(newVisibleDate);\n  };\n\n  const Weekdays = CustomWeekdays || DefaultWeekdays;\n  const Arrow = CustomArrow || DefaultArrow;\n  const Title = CustomTitle || DefaultTitle;\n\n  return (\n    <View style={theme.calendarContainer} testID={testID}>\n      <View testID={'header'} style={theme.headerContainer}>\n        <Arrow\n          direction={'left'}\n          isDisabled={leftArrowDisabled}\n          onPress={activeView === VIEW.MONTH ? subtractMonth : subtractYear}\n        />\n        <Title\n          activeView={activeView}\n          locale={locale}\n          date={localeAwareVisibleDate.format('YYYY-MM-DD')}\n          isDisabled={!allowYearView}\n          onPress={toggleCalendarView}\n        />\n        <Arrow\n          direction={'right'}\n          isDisabled={rightArrowDisabled}\n          onPress={activeView === VIEW.MONTH ? addMonth : addYear}\n        />\n      </View>\n      {activeView === VIEW.MONTH ? (\n        <>\n          <Weekdays days={weekdays} />\n          <Days\n            DayComponent={DayComponent}\n            visibleDate={localeAwareVisibleDate}\n            showExtraDates={!!showExtraDates}\n            dateProperties={dateProperties}\n            onPressDay={onPressDay}\n            minDate={minDate}\n            maxDate={maxDate}\n          />\n        </>\n      ) : (\n        <Months\n          MonthComponent={MonthComponent}\n          visibleDate={localeAwareVisibleDate}\n          minDate={minDate ? dayjs(minDate).local().format() : undefined}\n          maxDate={maxDate ? dayjs(maxDate).local().format() : undefined}\n          dateProperties={dateProperties}\n          onPressMonth={onPressMonth}\n        />\n      )}\n    </View>\n  );\n};\n\nexport default BaseCalendar;\n"]}